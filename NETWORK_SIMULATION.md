# üåê –°–∏—Å—Ç–µ–º–∞ –∏–º–∏—Ç–∞—Ü–∏–∏ —Å–µ—Ç–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏–π

–°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏–≥—Ä—ã –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∫–∞–∫ –æ–±—ã—á–Ω–æ
cd backend
go run cmd/server/main.go
```

### 2. –û—Ç–∫—Ä—ã—Ç–∏–µ –∏–≥—Ä—ã
–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `http://localhost:8080`

### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–∏—Ç–∞—Ü–∏–µ–π
- **–ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–Ω–µ–ª—å —Å–ø—Ä–∞–≤–∞ –≤ –∏–≥—Ä–µ
- **–ß–µ—Ä–µ–∑ API**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- **–ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `./test_network_sim.sh`

## üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ —Å–µ—Ç–∏

| –ü—Ä–æ—Ñ–∏–ª—å | –ë–∞–∑–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ | –í–∞—Ä–∏–∞—Ü–∏—è (jitter) | –ü–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|------------------|-------------------|----------------|----------|
| `wifi_good` | 20ms | ¬±10ms | 0.5% | –•–æ—Ä–æ—à–µ–µ WiFi —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ |
| `wifi_poor` | 80ms | ¬±40ms | 3% | –ü–ª–æ—Ö–æ–µ WiFi —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ |
| `mobile_4g` | 50ms | ¬±20ms | 1% | –ú–æ–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å 4G |
| `mobile_3g` | 100ms | ¬±50ms | 2% | –ú–æ–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å 3G |
| `high_latency` | 200ms | ¬±100ms | 5% | –í—ã—Å–æ–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ |
| `unstable` | 60ms | ¬±80ms | 4% | –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å |

## üîß API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –í–∫–ª—é—á–∏—Ç—å –∏–º–∏—Ç–∞—Ü–∏—é
```bash
POST /api/network-sim/enable?profile=wifi_good
```

### –û—Ç–∫–ª—é—á–∏—Ç—å –∏–º–∏—Ç–∞—Ü–∏—é
```bash
POST /api/network-sim/disable
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
```bash
GET /api/network-sim/status
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
./test_network_sim.sh
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–≥—Ä—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞—á–Ω–∏—Ç–µ –¥–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
3. –í–∫–ª—é—á–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –ø—Ä–æ—Ñ–∏–ª–µ–π —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —Å–ø—Ä–∞–≤–∞
4. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:
   - –ü–∏–Ω–≥ –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
   - –ü–ª–∞–≤–Ω–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è
   - –†–∞–±–æ—Ç–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

### –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

#### ‚úÖ –ú–µ—Ö–∞–Ω–∏–∑–º—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
- **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ–∏–∑–∏–∫–∞**: –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ –∏–≥—Ä–∞ –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é —Ñ–∏–∑–∏–∫—É
- **–°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ**: –î–≤–∏–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –ø–ª–∞–≤–Ω—ã–º–∏ –¥–∞–∂–µ –ø—Ä–∏ jitter
- **–ö–æ—Ä—Ä–µ–∫—Ü–∏—è**: –ü–æ–∑–∏—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

#### ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
- **–í—ã—Å–æ–∫–∏–π –ø–∏–Ω–≥**: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è
- **–ü–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤**: –ò–≥—Ä–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —á–∞—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏
- **–ü–∏–Ω–≥**: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
- **–†–µ–∂–∏–º —Ñ–∏–∑–∏–∫–∏**: –õ–æ–∫–∞–ª—å–Ω–∞—è/—Å–µ—Ä–≤–µ—Ä–Ω–∞—è
- **–í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏
```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ –∏–º–∏—Ç–∞—Ü–∏–∏
[NetworkSim] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: Enabled=true, BaseLatency=50ms, Variance=20ms, PacketLoss=1.00%

# –ü–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤
[NetworkSim] –ü–∞–∫–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω (1.0% loss rate)

# –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞
[NetworkSim] –ë—É—Ñ–µ—Ä –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Ä–∞–∑—É
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
curl http://localhost:8080/api/network-sim/status

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
# –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–º–∏—Ç–∞—Ü–∏–µ–π
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è [NetworkSim]

# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–æ—Ñ–∏–ª—å –ø—Ä–∏–º–µ–Ω–∏–ª—Å—è
curl http://localhost:8080/api/network-sim/status
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –≤ `backend/internal/transport/ws/server.go`:

```go
case "my_custom_profile":
    sim = NetworkSimulation{
        Enabled:         true,
        BaseLatency:     75 * time.Millisecond,
        LatencyVariance: 25 * time.Millisecond,
        PacketLoss:      0.015, // 1.5%
    }
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞
–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ `web/src/physics.js` –∏ `web/src/network.js` –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
```bash
# –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–ª–æ—Ö—É—é –º–æ–±–∏–ª—å–Ω—É—é —Å–µ—Ç—å
curl -X POST "http://localhost:8080/api/network-sim/enable?profile=mobile_3g"

# –ò–≥—Ä–∞–µ–º 2-3 –º–∏–Ω—É—Ç—ã, —Ç–µ—Å—Ç–∏—Ä—É–µ–º –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å

# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Ö–æ—Ä–æ—à—É—é —Å–µ—Ç—å
curl -X POST "http://localhost:8080/api/network-sim/enable?profile=wifi_good"
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
```bash
# –í—ã—Å–æ–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ + –ø–æ—Ç–µ—Ä–∏
curl -X POST "http://localhost:8080/api/network-sim/enable?profile=high_latency"

# –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å
curl -X POST "http://localhost:8080/api/network-sim/enable?profile=unstable"
```

## üéØ –¶–µ–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ü–ª–∞–≤–Ω–æ—Å—Ç—å –∏–≥—Ä—ã** –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö —Å–µ—Ç–∏
2. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π** –∏ –∏—Ö –∫–æ—Ä—Ä–µ–∫—Ü–∏—è
3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã** –∫ –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —É—Å–ª–æ–≤–∏—è–º
4. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** –ø—Ä–∏ –ø–æ—Ç–µ—Ä—è—Ö –ø–∞–∫–µ—Ç–æ–≤
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

–ü–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 50ms:

### –°–µ—Ä–≤–µ—Ä
- `DefaultUpdateInterval`: 50ms (20 FPS)
- `DefaultImpulseInterval`: 50ms (20 FPS)

### –ö–ª–∏–µ–Ω—Ç
- `UPDATE_INTERVAL`: 50ms
- `UPDATE_TIMEOUT`: 100ms (2x server interval)
- `TIMEOUT`: 150ms (3x server interval)
- `KEYBOARD_IMPULSE_INTERVAL`: 50ms
- `SEND_INTERVAL`: 50ms 